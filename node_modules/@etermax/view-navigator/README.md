[![Name Badge][name]][name-link]
[![Version Badge][version]][version-link]

[![Pipeline Badge][pipeline]][pipeline-link]
[![Open Issues Badge][open-issues]][open-issues-link]
[![Open Merge Requests Badge][open-merge-requests]][open-merge-requests-link]

[![Slack Badge][slack]][slack-link]

[name]: https://badges.etermax.com/packageJson?key=name&label=name&color=yellow&project=platform/skeletor/core/view-navigator
[name-link]: package.json
[version]: https://badges.etermax.com/packageJson?key=version&label=version&project=platform/skeletor/core/view-navigator
[version-link]: package.json
[pipeline]: https://badges.etermax.com/pipeline?project=platform/skeletor/core/view-navigator
[pipeline-link]: https://gitlab.etermax.net/platform/skeletor/core/view-navigator/pipelines
[open-issues]: https://badges.etermax.com/open-issues?project=platform/skeletor/core/view-navigator
[open-issues-link]: https://gitlab.etermax.net/platform/skeletor/core/view-navigator/issues?scope=all&utf8=âœ“&state=opened
[open-merge-requests]: https://badges.etermax.com/open-merge-requests?project=platform/skeletor/core/view-navigator
[open-merge-requests-link]: https://gitlab.etermax.net/platform/skeletor/core/view-navigator/merge_requests
[slack]: https://badges.etermax.com/slack?channel=ask-platform-team
[slack-link]: https://etermax.slack.com/app_redirect?channel=ask-platform-team


# View Navigator
- [Description](#description)
- [Unity View](#unity-view)
    - [Creation](#creation)
    - [Lifecycle](#lifecycle)
    - [Navigation](#navigation)
        - [Push View](#pushview)
        - [Push Overlay View](#pushoverlayview)
        - [ReplaceView](#replaceview)
        - [Restart Navigation](#restartnavigation)
        - [Navigate To Root](#navigatetoroot)
        - [Make Root](#makemeroot)
    - [Inner Views](#inner-views)
- [Tab Bar](#tabbar)
    - [Creation and Setup](#creation-and-setup)
    - [Properties](#properties)
        - [View Container](#view-container)
        - [Tab Bar Button Container](#Tab-Bar-Button-Container)
        - [Default Tab](#Default-Tab)
        - [Tab Views](#tab-views)
        - [Tab Bar Buttons Prefabs](#tab-bar-buttons-prefabs)
    - [Methods](#methods)
        - [NavigateToIndex](#NavigateToIndex)
        - [GetNavigatorFromTab](#GetNavigatorFromTab)
- [Navigator](#navigator)
    - [Starting the Navigation](#Starting-the-Navigation)
    - [Starting a new Navigation](#Starting-a-new-Navigation)
    


# Description

This packages provides a navigation framework that works with the Unity UI system. There are a few concepts you need to understand before reading how to use it.

`UnityView:` Component that allows you to override a `View` lifecycle and can be pushed to a `Navigator`.

`Navigator:` Is the object in charged to keep the history of the views navigation (views stack). And the responsable to call `Views` lifecycle.

`TabBar:` Is a component very similar to a UnityView but with some extra configurations. It respects the same UnityView lifecycle so you can treat it like anothe view.

# Unity View

## Creation

To create a UnityView it is recommended to use the built-in tool under Etermax->View Navigator-> Views. This will create every object/prefab you need to start creating your view.

![](readme-resources/view-creation.gif)

The Views tool will generate automatically the following folder structure:

![](readme-resources/folder-structure.png)

The structure is generated automatically and you can move your classes/prefabs wherever you want after being created.

`FirstView Folder:` Is the entire folder of your view.

`Presentation Folder:` Has everything related to presentation. Will contains the interface of your view and in case you selected MVP when creating the view will contains the view Presenter.

`Providers Folder:` Contains a class that provides an instance of the view and, in case you selected MVP when creating the view, the presenter. By default for prefab instantiation it will be using **ViewSettings.asset** (Similar as having a MonoBehaviour in the scene with dragged prefabs). You can change the provider code whenever you want.

`UnityDelivery/Prefabs Folder:` Contains the view prefab with the already dragged view component.

`UnityDelivery/Views Folder:` Contains the view component where you are going to insert your code.

## Lifecycle

![](readme-resources/unityview-lifecycle.png)

## Navigation

To navigate from a view to another you have available the following methods inside your view:

### **PushView**

This will push to a provided view, disabling the current view but leaving it inside the navigator stack.

```csharp
var view = MyViewProvider.View();
PushView(view);
```

![](readme-resources/pushview-example.gif)

### **PushOverlayView**

This will pop an overlay view. The current view will not be disabled, instead 
**DidShowOverlay** method will be called. And method **DidDismissOverlay** will be called when overlay view is dismissed.

```csharp
var view = MyViewProvider.View();
PushOverlayView(view);
```

![](readme-resources/pushoverlayview-example.gif)

### **ReplaceView**

This will replace the current view in the navigator stack with the view where you want to navigate.

```csharp
var view = MyViewProvider.View();
ReplaceView(view);
```

![](readme-resources/replaceview-example.gif)

### **RestartNavigation**

This will clear the navigator stack and will set the provided view as root.

```csharp
var view = MyViewProvider.View();
RestartNavigation(view);
```

![](readme-resources/restartnavigation-example.gif)

### **NavigateToRoot**

This will go to the navigator root view unloading the views from the stack.

```csharp
NavigateToRoot();
```

![](readme-resources/navigatetoroot-example.gif)

### **MakeMeRoot**

This will make the current view as root of the current navigator. **No lifecycle method will be called again** since the view is already in screen.

```csharp
MakeMeRoot();
```

![](readme-resources/makemeroot-example.gif)

## Inner Views

You can add UnityViews inside another one. The parent view will call inner views lifecylce methods.

# TabBar

The TabBar is another view but it has few extra behaviours. 

## Creation and Setup

To create a TabBar is similar to create a view but in order to work you need to assign views and button prefabs that later will be instantiated. The TabBar will generate a Navigator for each view so each tab will have it own navigation.

![](readme-resources/tabbar-creation.gif)

## Properties

### **View Container**

This container is the space reserved for views. Views will be children of this container and will be streched to fulfill all the space.

![](readme-resources/view-in-tabbar.gif)

### **Tab Bar Button Container**

This container will be the parent of the tab bar buttons. By default it has an HorizontalLayout component to distribute horizontally all buttons.

### **Default Tab**

This is de index of the default button that will be active when navigate to tab bar.

![](readme-resources/defaulttab-example.gif)

### **Tab Views**

The list of views that this tab bar will handle.

### **Tab Bar Buttons Prefabs**

The list of buttons that this tab bar will instantiate. The button must match with the view index you want thsi button represent.

## Methods

### **NavigateToIndex**

If you want to change the tab from outside of the tab you need to call `NavigateToIndex` passing the index of the button/view you want to select.

### **GetNavigatorFromTab**

If you need to access to an specific navigator inside the tab you can use `GetNavigatorFromTab` passing the index of button/view you want. This is useful for automatize flows, like deeplinks.

# Navigator

The Navigator is the core of this package, everything happens through it. Each Navigator represents a unique navigation and you can have multiple navigators.

## Starting the Navigation

```csharp
void Start() {
    var myFirstView = FirstViewProvider.View();
    Navigator
        .WithRootView(myFirstView)
        .DoWhenBackOnEmptyStack(() => { Debug.Log("There are no more views"); })
        .Animated(true)
        .Build()
        .StartNavigation();
}
```

## Starting a new Navigation

Since the Navigator implements View itself you can navigate to a Navigator just like you do with views. This will start a new navigation. Each Navigator has it own navigation stack.

```csharp
var newView = DemoViewsProvider.GetOtherOneView();
var newNavigator = Navigator.Create(newView);
PushView(newNavigator)
```

![](readme-resources/navigate-navigator.gif)

# Dependencies

```json
"@etermax/unity-rx": "6.1.2"
"@etermax/extensions": "1.0.0"
"@etermax/unity-editor-extensions": "2.x"
"@etermax/unity-editor-layout": "1.0.0"
"@etermax/rx-tweener": "3.0.2"
"@etermax/gameobject-extensions": "0.0.1"
"@etermax/functional": "1.0.1"
"@etermax/unity-canvas-provider": "0.0.1-beta"
```