using Etermax.ViewNavigator.Domain;
using Etermax.ViewNavigator.Infrastructure.Editor.Utilities;
using UnityEditor;
using UnityEditorLayoutWrapper.Components;
using UnityEngine;

namespace Etermax.ViewNavigator.Infrastructure.Editor
{
    [CustomEditor(typeof(UnityView), true)]
    public class ViewCustomEditor : UnityEditor.Editor
    {
        private GameObject _targetGameObject;

        private void OnEnable()
        {
            _targetGameObject = ((UnityView) target).gameObject;
        }

        public override void OnInspectorGUI()
        {
            if (!_targetGameObject.activeInHierarchy)
            {
                DrawCreateInstanceButton();
            }

            base.OnInspectorGUI();
        }

        private void DrawCreateInstanceButton()
        {
            ComposedLayout.Header("View");
            Layout.HorizontalWhiteBox(() =>
            {
                Button.Custom("Instantiate on Canvas", () => ViewUtilities.InstantiateOnCanvas(_targetGameObject));
            });
        }
    }
}