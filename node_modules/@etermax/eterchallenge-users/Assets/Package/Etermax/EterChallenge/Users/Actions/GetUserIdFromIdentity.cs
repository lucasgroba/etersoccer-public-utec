using System;
using Package.Etermax.EterChallenge.Users.Domain;
using UniRx;

namespace Package.Etermax.EterChallenge.Users.Actions
{
    public class GetUserIdFromIdentity
    {
        private readonly IGetUserIdFromIdentityService _getUserIdFromIdentityService;

        public GetUserIdFromIdentity(IGetUserIdFromIdentityService getUserIdFromIdentityService)
        {
            _getUserIdFromIdentityService = getUserIdFromIdentityService;
        }

        public virtual IObservable<string> Execute(string provider, string providerUserId)
        {
            return provider.Equals(IdentityProviders.Application) ||
                   provider.Equals(IdentityProviders.RecentInteractions)
                ? Observable.Return(providerUserId)
                : _getUserIdFromIdentityService.Execute(provider, providerUserId);
        }
    }
}